/* Pi-hole: A black hole for Internet advertisements
 *  (c) 2017 Pi-hole, LLC (https://pi-hole.net)
 *  Network-wide ad blocking via your own hardware.
 *
 *  This file is copyright under the latest version of the EUPL.
 *  Please see LICENSE file for your rights under this license.  */

/* global moment:false, utils:false */

var tableApi;
var tableFilters = [];

var replyTypes = [
  "N/A",
  "NODATA",
  "NXDOMAIN",
  "CNAME",
  "IP",
  "DOMAIN",
  "RRNAME",
  "SERVFAIL",
  "REFUSED",
  "NOTIMP",
  "upstream error",
  "DNSSEC",
  "NONE",
  "BLOB",
];
var colTypes = ["time", "query type", "domain", "client", "status", "reply type"];

function handleAjaxError(xhr, textStatus) {
  if (textStatus === "timeout") {
    alert("The server took too long to send the data.");
  } else if (xhr.responseText.indexOf("Connection refused") === -1) {
    alert("An unknown error occurred while loading the data.\n" + xhr.responseText);
  } else {
    alert("An error occurred while loading the data: Connection refused. Is FTL running?");
  }

  $("#all-queries_processing").hide();
  tableApi.clear();
  tableApi.draw();
}

$(function () {
  // Do we want to filter queries?
  var GETDict = {};
  window.location.search
    .substr(1)
    .split("&")
    .forEach(function (item) {
      GETDict[item.split("=")[0]] = item.split("=")[1];
    });

  var APIstring = "api.php?getAllQueries";

  if ("from" in GETDict && "until" in GETDict) {
    APIstring += "&from=" + GETDict.from;
    APIstring += "&until=" + GETDict.until;
  } else if ("client" in GETDict) {
    APIstring += "&client=" + GETDict.client;
  } else if ("domain" in GETDict) {
    APIstring += "&domain=" + GETDict.domain;
  } else if ("querytype" in GETDict) {
    APIstring += "&querytype=" + GETDict.querytype;
  } else if ("forwarddest" in GETDict) {
    APIstring += "&forwarddest=" + GETDict.forwarddest;
  }
  // If we don't ask filtering and also not for all queries, just request the most recent 100 queries
  else if (!("all" in GETDict)) {
    APIstring += "=100";
  }

  if ("type" in GETDict) {
    APIstring += "&type=" + GETDict.type;
  }

  tableApi = $("#all-queries").DataTable({
    rowCallback: function (row, data) {
      var replyid = parseInt(data[5], 10);
      // DNSSEC status
      var dnssecStatus;
      var ede = data[11] ? data[11] : "";
      switch (data[6]) {
        case "1":
          dnssecStatus = '<br><span class="text-green">SECURE';
          break;
        case "2":
          dnssecStatus = '<br><span class="text-orange">INSECURE';
          break;
        case "3":
          dnssecStatus = '<br><span class="text-red">BOGUS';
          break;
        case "4":
          dnssecStatus = '<br><span class="text-red">ABANDONED';
          break;
        case "5":
          dnssecStatus = '<br><span class="text-orange">UNKNOWN';
          break;
        default:
          // No DNSSEC
          dnssecStatus = "";
      }

      if (dnssecStatus.length > 0) {
        if (ede.length > 0) dnssecStatus += " (" + ede + ")";
        else if (replyid === 7) dnssecStatus += " (refused upstream)";
        dnssecStatus += "</span>";
      }

      // Query status
      var fieldtext,
        buttontext = "",
        blocked = false,
        isCNAME = false,
        DomainlistLink = false;

      // accompanies Store domainlist IDs for blocked/permitted queries FTL PR 1409
      if (data.length > 9 && Number.isInteger(parseInt(data[9], 10)) && data[9] > 0) {
        DomainlistLink = true;
      }

      switch (data[4]) {
        case "1":
          fieldtext = "<span class='text-red'>Blocked (gravity)</span>";
          buttontext =
            '<button type="button" class="btn btn-default btn-sm text-green btn-whitelist"><i class="fas fa-check"></i> Whitelist</button>';
          blocked = true;
          break;
        case "2":
          fieldtext =
            replyid === 0
              ? "<span class='text-green'>OK</span> (sent to <br class='hidden-lg'>"
              : "<span class='text-green'>OK</span> (answered by <br class='hidden-lg'>";
          fieldtext +=
            (data.length > 10 && data[10] !== "N/A" ? data[10] : "") + ")" + dnssecStatus;
          buttontext =
            '<button type="button" class="btn btn-default btn-sm text-red btn-blacklist"><i class="fa fa-ban"></i> Blacklist</button>';
          break;
        case "3":
          fieldtext =
            "<span class='text-green'>OK</span> <br class='hidden-lg'>(cache)" + dnssecStatus;
          buttontext =
            '<button type="button" class="btn btn-default btn-sm text-red btn-blacklist"><i class="fa fa-ban"></i> Blacklist</button>';
          break;
        case "4":
          fieldtext = "<span class='text-red'>Blocked <br class='hidden-lg'>(regex blacklist)";
          blocked = true;
          buttontext =
            '<button type="button" class="btn btn-default btn-sm text-green btn-whitelist"><i class="fas fa-check"></i> Whitelist</button>';
          break;
        case "5":
          fieldtext = "<span class='text-red'>Blocked <br class='hidden-lg'>(exact blacklist)";
          blocked = true;
          buttontext =
            '<button type="button" class="btn btn-default btn-sm text-green btn-whitelist"><i class="fas fa-check"></i> Whitelist</button>';
          break;
        case "6":
          fieldtext = "<span class='text-red'>Blocked <br class='hidden-lg'>(external, IP)";
          blocked = true;
          buttontext = "";
          break;
        case "7":
          fieldtext =
            "<span class='text-red'>Blocked <br class='hidden-lg'>(external, NULL)</span>";
          blocked = true;
          buttontext = "";
          break;
        case "8":
          fieldtext =
            "<span class='text-red'>Blocked <br class='hidden-lg'>(external, NXRA)</span>";
          blocked = true;
          buttontext = "";
          break;
        case "9":
          fieldtext =
            "<span class='text-red'>Blocked <br class='hidden-lg'>(gravity, CNAME)</span>";
          blocked = true;
          buttontext =
            '<button type="button" class="btn btn-default btn-sm text-green btn-whitelist"><i class="fas fa-check"></i> Whitelist</button>';
          isCNAME = true;
          break;
        case "10":
          fieldtext =
            "<span class='text-red'>Blocked <br class='hidden-lg'>(regex blacklist, CNAME)</span>";
          blocked = true;
          buttontext =
            '<button type="button" class="btn btn-default btn-sm text-green btn-whitelist"><i class="fas fa-check"></i> Whitelist</button>';
          isCNAME = true;
          break;
        case "11":
          fieldtext =
            "<span class='text-red'>Blocked <br class='hidden-lg'>(exact blacklist, CNAME)</span>";
          blocked = true;
          buttontext =
            '<button type="button" class="btn btn-default btn-sm text-green btn-whitelist"><i class="fas fa-check"></i> Whitelist</button>';
          isCNAME = true;
          break;
        case "12":
          fieldtext = "<span class='text-green'>Retried</span>";
          break;
        case "13":
          fieldtext = "<span class='text-green'>Retried</span> <br class='hidden-lg'>(ignored)";
          break;
        case "14":
          fieldtext =
            "<span class='text-green'>OK</span> <br class='hidden-lg'>(already forwarded)" +
            dnssecStatus;
          buttontext =
            '<button type="button" class="btn btn-default btn-sm text-red btn-blacklist"><i class="fa fa-ban"></i> Blacklist</button>';
          break;
        case "15":
          fieldtext =
            "<span class='text-orange'>Blocked <br class='hidden-lg'>(database is busy)</span>";
          blocked = true;
          break;
        case "16":
          fieldtext =
            "<span class='text-orange'>Blocked <br class='hidden-lg'>(special domain)</span>";
          blocked = true;
          break;
        case "17":
          fieldtext =
            "<span class='text-orange'>OK</span> <br class='hidden-lg'>(stale cache)" +
            dnssecStatus;
          buttontext =
            '<button type="button" class="btn btn-default btn-sm text-red btn-blacklist"><i class="fa fa-ban"></i> Blacklist</button>';
          break;
        default:
          fieldtext = "Unknown (" + parseInt(data[4], 10) + ")";
      }

      // Add EDE here if available and not included in dnssecStatus
      if (ede.length > 0 && dnssecStatus.length === 0) fieldtext += " (" + ede + ")";

      // Cannot block internal queries of this type
      if ((data[1] === "DNSKEY" || data[1] === "DS") && data[3] === "pi.hole") buttontext = "";

      fieldtext += '<input type="hidden" name="id" value="' + parseInt(data[4], 10) + '">';

      $(row).addClass(blocked === true ? "blocked-row" : "allowed-row");
      if (localStorage && localStorage.getItem("colorfulQueryLog_chkbox") === "true") {
        $(row).addClass(blocked === true ? "text-red" : "text-green");
      }

      $("td:eq(4)", row).html(fieldtext);
      $("td:eq(6)", row).html(buttontext);

      if (DomainlistLink) {
        $("td:eq(4)", row).on(
          "hover",
          (function () {
            this.title = "Click to show matching blacklist/whitelist domain";
            this.style.color = "#72afd2";
          },
          function () {
            this.style.color = "";
          })
        );
        $("td:eq(4)", row).off(); // Release any possible previous onClick event handlers
        $("td:eq(4)", row).on("click", function () {
          var newTab = window.open("groups-domains.php?domainid=" + data[9], "_blank");
          if (newTab) {
            newTab.focus();
          }
        });
        $("td:eq(4)", row).addClass("text-underline pointer");
      }

      var domain = data[2];
      if (isCNAME) {
        var CNAMEDomain = data[8];
        // Add domain in CNAME chain causing the query to have been blocked
        $("td:eq(2)", row).text(domain + "\n(blocked " + CNAMEDomain + ")");
      } else {
        $("td:eq(2)", row).text(domain);
      }

      // Check for existence of sixth column and display only if not Pi-holed
      var replytext =
        replyid >= 0 && replyid < replyTypes.length ? replyTypes[replyid] : "? (" + replyid + ")";

      replytext += '<input type="hidden" name="id" value="' + replyid + '">';

      $("td:eq(5)", row).html(replytext);

      // Show response time only when reply is not N/A
      if (data.length > 7 && replyid !== 0) {
        var content = $("td:eq(5)", row).html();
        $("td:eq(5)", row).html(content + " (" + (0.1 * data[7]).toFixed(1) + "ms)");
      }
    },
    dom:
      "<'row'<'col-sm-12'f>>" +
      "<'row'<'col-sm-4'l><'col-sm-8'p>>" +
      "<'row'<'col-sm-12'<'table-responsive'tr>>>" +
      "<'row'<'col-sm-5'i><'col-sm-7'p>>",
    ajax: {
      url: APIstring,
      error: handleAjaxError,
      dataSrc: function (data) {
        if ("FTLnotrunning" in data) {
          // if FTL is not running, return empyt array (empty table)
          utils.showAlert(
            "error",
            "",
            "Error while deleting DHCP lease for ",
            "FTL is not running"
          );
          data = {};
          return data;
        } else {
          var dataIndex = 0;
          return data.data.map(function (x) {
            x[0] = x[0] * 1e6 + dataIndex++;
            var dnssec = x[5];
            var reply = x[6];
            x[5] = reply;
            x[6] = dnssec;
            return x;
          });
        }
      },
    },
    autoWidth: false,
    processing: true,
    order: [[0, "desc"]],
    columns: [
      {
        width: "15%",
        render: function (data, type) {
          if (type === "display") {
            return moment
              .unix(Math.floor(data / 1e6))
              .format("Y-MM-DD [<br class='hidden-lg'>]HH:mm:ss z");
          }

          return data;
        },
      },
      { width: "4%" },
      { width: "36%" },
      { width: "8%", type: "ip-address" },
      { width: "14%", orderData: 4 },
      { width: "8%", orderData: 5 },
      { width: "10%", orderData: 4 },
    ],
    lengthMenu: [
      [10, 25, 50, 100, -1],
      [10, 25, 50, 100, "All"],
    ],
    stateSave: true,
    stateDuration: 0,
    stateSaveCallback: function (settings, data) {
      utils.stateSaveCallback("query_log_table", data);
    },
    stateLoadCallback: function () {
      return utils.stateLoadCallback("query_log_table");
    },
    columnDefs: [
      {
        targets: -1,
        data: null,
        defaultContent: "",
      },
      {
        targets: "_all",
        render: $.fn.dataTable.render.text(),
      },
    ],
    initComplete: function () {
      var api = this.api();

      // Query type IPv4 / IPv6
      api
        .$("td:eq(1)")
        .on("click", function (event) {
          addColumnFilter(event, 1, this.textContent);
        })
        .on(
          "hover",
          (function () {
            $(this).addClass("pointer").attr("title", tooltipText(1, this.textContent));
          },
          function () {
            $(this).removeClass("pointer");
          })
        );

      // Domain
      api
        .$("td:eq(2)")
        .on("click", function (event) {
          addColumnFilter(event, 2, this.textContent.split("\n")[0]);
        })
        .on(
          "hover",
          (function () {
            $(this).addClass("pointer").attr("title", tooltipText(2, this.textContent));
          },
          function () {
            $(this).removeClass("pointer");
          })
        );

      // Client
      api
        .$("td:eq(3)")
        .on("click", function (event) {
          addColumnFilter(event, 3, this.textContent);
        })
        .on(
          "hover",
          (function () {
            $(this).addClass("pointer").attr("title", tooltipText(3, this.textContent));
          },
          function () {
            $(this).removeClass("pointer");
          })
        );

      // Status
      api
        .$("td:eq(4)")
        .on("click", function (event) {
          var id = this.children.id.value;
          var text = this.textContent;
          addColumnFilter(event, 4, id + "#" + text);
        })
        .on(
          "hover",
          (function () {
            $(this).addClass("pointer").attr("title", tooltipText(4, this.textContent));
          },
          function () {
            $(this).removeClass("pointer");
          })
        );

      // Reply type
      api
        .$("td:eq(5)")
        .on("click", function (event) {
          var id = this.children.id.value;
          var text = this.textContent.split(" ")[0];
          addColumnFilter(event, 5, id + "#" + text);
        })
        .on(
          "hover",
          (function () {
            $(this).addClass("pointer").attr("title", tooltipText(5, this.textContent));
          },
          function () {
            $(this).removeClass("pointer");
          })
        );

      // Disable autocorrect in the search box
      var input = $("input[type=search]");
      if (input !== null) {
        input.attr("autocomplete", "off");
        input.attr("autocorrect", "off");
        input.attr("autocapitalize", "off");
        input.attr("spellcheck", false);
        input.attr("placeholder", "Type / Domain / Client");
      }
    },
  });

  resetColumnsFilters();

  $("#all-queries tbody").on("click", "button", function () {
    var data = tableApi.row($(this).parents("tr")).data();
    if (data[4] === "2" || data[4] === "3" || data[4] === "14" || data[4] === "17") {
      utils.addFromQueryLog(data[2], "black");
    } else {
      utils.addFromQueryLog(data[2], "white");
    }
  });

  $("#resetButton").on("click", function () {
    tableApi.search("");
    resetColumnsFilters();
  });
});

function tooltipText(index, text) {
  if (index === 5) {
    // Strip reply time from tooltip text
    text = text.split(" ")[0];
  }

  if (index in tableFilters && tableFilters[index].length > 0) {
    return "Click to remove " + colTypes[index] + ' "' + text + '" from filter.';
  }

  return "Click to add " + colTypes[index] + ' "' + text + '" to filter.';
}

function addColumnFilter(event, colID, filterstring) {
  // If the below modifier keys are held down, do nothing
  if (event.ctrlKey || event.metaKey || event.altKey) {
    return;
  }

  if (tableFilters[colID] === filterstring) {
    filterstring = "";
  }

  tableFilters[colID] = filterstring;

  applyColumnFiltering();
}

function resetColumnsFilters() {
  tableFilters.forEach(function (value, index) {
    tableFilters[index] = "";
  });

  // Clear filter reset button
  applyColumnFiltering();
}

function applyColumnFiltering() {
  var showReset = false;
  tableFilters.forEach(function (value, index) {
    // Prepare regex filter string
    var regex = "";

    // Split filter string if we received a combined ID#Name column
    var valArr = value.split("#");
    if (valArr.length > 0) {
      value = valArr[0];
    }

    if (value.length > 0) {
      // Exact matching
      regex = "^" + value + "$";

      // Add background color
      tableApi.$("td:eq(" + index + ")").addClass("highlight");

      // Remember to show reset button
      showReset = true;
    } else {
      // Clear background color
      tableApi.$("td:eq(" + index + ")").removeClass("highlight");
    }

    // Apply filtering on this column (regex may be empty -> no filtering)
    tableApi.column(index).search(regex, true, true);
  });

  if (showReset) {
    $("#resetButton").removeClass("hidden");
  } else {
    $("#resetButton").addClass("hidden");
  }

  // Trigger table update
  tableApi.draw();
}
A·Åmf      eå¶žeå¶ŸF¢'eè-b   …    O^partitionKey=%28https%2Capex-migrations.net%29,:https://pihole.apex-migrations.net/admin/scripts/pi-hole/js/queries.js?v=1707938340 strongly-framed 1 security-info FnhllAKWRHGAlo+ESXykKAAAAAAAAAAAwAAAAAAAAEaphjojH6pBabDSgSnsfLHeAAAAAgAAAAAAAAAAAAAAAAAAAAEAOQFmCjImkVxP+7sgiYWmMt8FvcOXmlQiTNWFiWlrbpbqgwAAAAAAAAYHMIIGAzCCBOugAwIBAgISBCnXMDCdCc7RcYtSIMPSrTIqMA0GCSqGSIb3DQEBCwUAMDIxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MQswCQYDVQQDEwJSMzAeFw0yNDAxMjgwNzQ3MTBaFw0yNDA0MjcwNzQ3MDlaMCUxIzAhBgNVBAMTGnBpaG9sZS5hcGV4LW1pZ3JhdGlvbnMubmV0MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA0i/z93QL4UJpWGvUqb+kIQHZpwVgCYeFSvUNTKXYhQs9piCVxqd86fcP38/omsCI7cZvV59xOO+spOezpwtdQPC7tD3wwejMrHOWjvJdDYJrwc2+g8cr0kfq5nyuCtZZ2gJMSdJIjCssaywc+VeREDVUAH7Puxi0JWWbuQoooc/t1UEfeKQrSTnHtBKLhdQ4xksbTYgnstBemOZtPnwP8cGrOccROKy0BLW0xNN9PLEMFzQLsNkplig3KgmsBRIvvdbd5lxEh2WPG0sY1qqjWcNzqUYoA35TDu21lrmzDrkGg9oGyLAC7gEzhbUxdmy7bUGLgcST09vOOTF489in/mo4u1SWoR3qcgFckpaCLza30YT5zujueLBCacM82x/q8BtwHVvVjA631mQNpp7nmgakrXqcZznIsHOPb+duF6KaAxS3BIWUlBTldt9p1ZmFB0xnZ7PqRspD3GQNPu2phJxQDTvgCwgsqckXUKb0zQnvH6NMafuGcEH93SYQODZOPIKijdrwEiZ3J/AG6NT31wBlqhaQk7U2Dlm2AiTun/0bEdHZrvfw3yoRZiC2/tWk/Svr2ufGSK6hphY66P2uVklQIZn7MNQoZR9vQJVEyOp0K4kxcmOzAfhkX6tbkt9FvzdLJwBNuxvorknBSt3FJZK27IClwL4z6c5Hfh+nISsCAwEAAaOCAh4wggIaMA4GA1UdDwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADAdBgNVHQ4EFgQUMJLwOuUdK98vjTkrEbvvioH/k84wHwYDVR0jBBgwFoAUFC6zF7dYVsuuUAlA5h+vnYsUwsYwVQYIKwYBBQUHAQEESTBHMCEGCCsGAQUFBzABhhVodHRwOi8vcjMuby5sZW5jci5vcmcwIgYIKwYBBQUHMAKGFmh0dHA6Ly9yMy5pLmxlbmNyLm9yZy8wJQYDVR0RBB4wHIIacGlob2xlLmFwZXgtbWlncmF0aW9ucy5uZXQwEwYDVR0gBAwwCjAIBgZngQwBAgEwggEGBgorBgEEAdZ5AgQCBIH3BIH0APIAdwBIsONr2qZHNA/lagL6nTDrHFIBy1bdLIHZu7+rOdiEcwAAAY1PQE18AAAEAwBIMEYCIQCYKShWEpjYjY9J/ELTQ5Vw17CIYNSmP5JKvgV/oxJUcAIhAJ8qKbGussH0JDTlOr5NGjFPG31jnxXx+mg7NFNHVNIrAHcAO1N3dT4tuYBOizBbBv5AO2fYT8P0x70ADS1yb+H61BcAAAGNT0BNmQAABAMASDBGAiEA5k70Lb0kudTH+22nUp01wNkbEr3Ve0wSDKmlqmJUVHsCIQDYsAQoTqfHOronwYW9ExH/UCINaTO/IKsdiaJAy5O3ADANBgkqhkiG9w0BAQsFAAOCAQEAL6V0AaAXcV5Rfc3kv3dczqQR9MCpukheUgxWfgQE2V8GB8CvHUg695wG0GFxI6BM6TN4PdyGnr/06AGX1zjdlTcKhbw83OMRjgDRa6jXoK20XoHyR7T16WTG/8M9wImUyNuLE1uM1PouuhURhxr24RkhzXnGW4/XC3lbM4g+mzj7qOZICPUT6n4jk5Z/w61sWP4HjMaIeBqXfup4mtJJqr419tPYfdxRcmQzuN85L1SHJdxhf4+bavEP9fhjltsFrcPCssc+SGKoUST5gmWJr46e4lLYMkmk/BaduHfJ3MxgmfoZJJwqtmOo81xeriipf1gE6IZmMGOc2PedYkMiIxMBAAQAAAAAAAEBAAAAAAAABngyNTUxOQAAAA5SU0EtUFNTLVNIQTI1NgADZgoyJpFcT/u7IImFpjLfBb3Dl5pUIkzVhYlpa26W6oMAAAAAAAAGBzCCBgMwggTroAMCAQICEgQp1zAwnQnO0XGLUiDD0q0yKjANBgkqhkiG9w0BAQsFADAyMQswCQYDVQQGEwJVUzEWMBQGA1UEChMNTGV0J3MgRW5jcnlwdDELMAkGA1UEAxMCUjMwHhcNMjQwMTI4MDc0NzEwWhcNMjQwNDI3MDc0NzA5WjAlMSMwIQYDVQQDExpwaWhvbGUuYXBleC1taWdyYXRpb25zLm5ldDCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBANIv8/d0C+FCaVhr1Km/pCEB2acFYAmHhUr1DUyl2IULPaYglcanfOn3D9/P6JrAiO3Gb1efcTjvrKTns6cLXUDwu7Q98MHozKxzlo7yXQ2Ca8HNvoPHK9JH6uZ8rgrWWdoCTEnSSIwrLGssHPlXkRA1VAB+z7sYtCVlm7kKKKHP7dVBH3ikK0k5x7QSi4XUOMZLG02IJ7LQXpjmbT58D/HBqznHETistAS1tMTTfTyxDBc0C7DZKZYoNyoJrAUSL73W3eZcRIdljxtLGNaqo1nDc6lGKAN+Uw7ttZa5sw65BoPaBsiwAu4BM4W1MXZsu21Bi4HEk9PbzjkxePPYp/5qOLtUlqEd6nIBXJKWgi82t9GE+c7o7niwQmnDPNsf6vAbcB1b1YwOt9ZkDaae55oGpK16nGc5yLBzj2/nbheimgMUtwSFlJQU5XbfadWZhQdMZ2ez6kbKQ9xkDT7tqYScUA074AsILKnJF1Cm9M0J7x+jTGn7hnBB/d0mEDg2TjyCoo3a8BImdyfwBujU99cAZaoWkJO1Ng5ZtgIk7p/9GxHR2a738N8qEWYgtv7VpP0r69rnxkiuoaYWOuj9rlZJUCGZ+zDUKGUfb0CVRMjqdCuJMXJjswH4ZF+rW5LfRb83SycATbsb6K5JwUrdxSWStuyApcC+M+nOR34fpyErAgMBAAGjggIeMIICGjAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMAwGA1UdEwEB/wQCMAAwHQYDVR0OBBYEFDCS8DrlHSvfL405KxG774qB/5POMB8GA1UdIwQYMBaAFBQusxe3WFbLrlAJQOYfr52LFMLGMFUGCCsGAQUFBwEBBEkwRzAhBggrBgEFBQcwAYYVaHR0cDovL3IzLm8ubGVuY3Iub3JnMCIGCCsGAQUFBzAChhZodHRwOi8vcjMuaS5sZW5jci5vcmcvMCUGA1UdEQQeMByCGnBpaG9sZS5hcGV4LW1pZ3JhdGlvbnMubmV0MBMGA1UdIAQMMAowCAYGZ4EMAQIBMIIBBgYKKwYBBAHWeQIEAgSB9wSB9ADyAHcASLDja9qmRzQP5WoC+p0w6xxSActW3SyB2bu/qznYhHMAAAGNT0BNfAAABAMASDBGAiEAmCkoVhKY2I2PSfxC00OVcNewiGDUpj+SSr4Ff6MSVHACIQCfKimxrrLB9CQ05Tq+TRoxTxt9Y58V8fpoOzRTR1TSKwB3ADtTd3U+LbmAToswWwb+QDtn2E/D9Me9AA0tcm/h+tQXAAABjU9ATZkAAAQDAEgwRgIhAOZO9C29JLnUx/ttp1KdNcDZGxK91XtMEgyppapiVFR7AiEA2LAEKE6nxzq6J8GFvRMR/1AiDWkzvyCrHYmiQMuTtwAwDQYJKoZIhvcNAQELBQADggEBAC+ldAGgF3FeUX3N5L93XM6kEfTAqbpIXlIMVn4EBNlfBgfArx1IOvecBtBhcSOgTOkzeD3chp6/9OgBl9c43ZU3CoW8PNzjEY4A0Wuo16CttF6B8ke09elkxv/DPcCJlMjbixNbjNT6LroVEYca9uEZIc15xluP1wt5WzOIPps4+6jmSAj1E+p+I5OWf8OtbFj+B4zGiHgal37qeJrSSaq+NfbT2H3cUXJkM7jfOS9UhyXcYX+Pm2rxD/X4Y5bbBa3DwrLHPkhiqFEk+YJlia+OnuJS2DJJpPwWnbh3ydzMYJn6GSScKrZjqPNcXq4oqX9YBOiGZjBjnNj3nWJDIiNmCjImkVxP+7sgiYWmMt8FvcOXmlQiTNWFiWlrbpbqgwAAAAAAAAUaMIIFFjCCAv6gAwIBAgIRAJErCErPDBinU/bWLiWnX1owDQYJKoZIhvcNAQELBQAwTzELMAkGA1UEBhMCVVMxKTAnBgNVBAoTIEludGVybmV0IFNlY3VyaXR5IFJlc2VhcmNoIEdyb3VwMRUwEwYDVQQDEwxJU1JHIFJvb3QgWDEwHhcNMjAwOTA0MDAwMDAwWhcNMjUwOTE1MTYwMDAwWjAyMQswCQYDVQQGEwJVUzEWMBQGA1UEChMNTGV0J3MgRW5jcnlwdDELMAkGA1UEAxMCUjMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC7AhUozPaglNMPEuyNVZLD+ILxmaZ6QoinXSaqtSu5xUyxr45r+XXIo9cPR5QUVTVXjJ6oojkZ9YI8QqlObvU7wy7bjcCwXPNZOOftz2nwWgsbvsCUJCWH+jdxsxPnHKzhm+/b5DtFUkWWqcFTzjTIUu61ru2P3mBw4qVUq7ZtDpelQDRrK9O8ZutmNHz6a4uPVymZ+DAXXbpyb/uBxa3Shlg9F8fnCbvxK/eG3MHacV3URuPMrSXBiLxgZ3Vms/EY96Jc5lP/Ooi2R6X/ExjqmAl3P51T+c8B5fWmcBcUr2Ok/5mzk53cU6cG/kiFHaFpriV1uxPMUgP17VGhi9sVAgMBAAGjggEIMIIBBDAOBgNVHQ8BAf8EBAMCAYYwHQYDVR0lBBYwFAYIKwYBBQUHAwIGCCsGAQUFBwMBMBIGA1UdEwEB/wQIMAYBAf8CAQAwHQYDVR0OBBYEFBQusxe3WFbLrlAJQOYfr52LFMLGMB8GA1UdIwQYMBaAFHm0WeZ7tuXkAXOACIjIGlj26ZtuMDIGCCsGAQUFBwEBBCYwJDAiBggrBgEFBQcwAoYWaHR0cDovL3gxLmkubGVuY3Iub3JnLzAnBgNVHR8EIDAeMBygGqAYhhZodHRwOi8veDEuYy5sZW5jci5vcmcvMCIGA1UdIAQbMBkwCAYGZ4EMAQIBMA0GCysGAQQBgt8TAQEBMA0GCSqGSIb3DQEBCwUAA4ICAQCFyk5HPqP3hUSFvNVneLKYY611TR6WPTNlclQtgaDqw+34IL9fzLdwALduO/ZelN7kIJ+m74uyA+eitRY8kc607TkC53wlikfmZW4/RvTZ8M6UK+5UzhK8jCdLuMGYL6KvzXGRSgi3yLgjewQtCPkIVz6D2QQzCkcheAmCJ8MqyJu5zlzyZMjAvnnAT45tRAxekrsu94sQ4egdRCnbWSDtY7kh+BImlJNXoB1lBMEKIq4QDUOXoRgffuDghje1WrG9ML+Hbisq/yFOGwXD9RiX8F6sw6W4avAuvDszue5L3sz85K+EC4Y/wFVDNvZo4TYXao6Z0f+lQKc0t8DQYzk1OXVu8rp2yJMC6alLbBfODALZvYH7n7do1AZls4I9d1P4jnkDrQoxB3UqQ9hVl3LEKQ73xF1OyK5GhDDX8oVfGKF5u+decIsH4YaTw7mP3GFxJSqv3+0lUFJoi5Lc5da149p90IdshCExroL1+7mryIkXPeFM5TgO9r0rvZaBFOvV2z0gp35Z0+L4WPlbuEjN/lxPFin+HlUjr8gRsI3qfJOQFy/9rKIJR0Y/8Omwt/8oTWgy1mdeHmmjk7j1nYsvC9JSQ6ZvMldlTTKB3zhThV1+XWYp6rjd5JW1zbVWEkLNxE7GJThEUG3szgBVGP7pSWTUTsqXnLRbwHOoq7hHwmYKMiaRXE/7uyCJhaYy3wW9w5eaVCJM1YWJaWtuluqDAAAAAAAABW8wggVrMIIDU6ADAgECAhEAghDPsNJA41lEY+C7Y4KLADANBgkqhkiG9w0BAQsFADBPMQswCQYDVQQGEwJVUzEpMCcGA1UEChMgSW50ZXJuZXQgU2VjdXJpdHkgUmVzZWFyY2ggR3JvdXAxFTATBgNVBAMTDElTUkcgUm9vdCBYMTAeFw0xNTA2MDQxMTA0MzhaFw0zNTA2MDQxMTA0MzhaME8xCzAJBgNVBAYTAlVTMSkwJwYDVQQKEyBJbnRlcm5ldCBTZWN1cml0eSBSZXNlYXJjaCBHcm91cDEVMBMGA1UEAxMMSVNSRyBSb290IFgxMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAregkc/QUN/ObnitXKByHvty33ziQjG485legePd1wqL+9Wpu9gBPKNveaIZsRJO2sWP9FBJrvx/S6jGbIX7RMzy6SPXded+zuP8S8SGaS8GKhnFpSmZmbI9+PHC/rSkiBvPkwOaAruJLj7eZfpQDn9NHl3yZSCNT6DiuTwpvgy7RSVeMgHS22i/QOI17A3AhG3XyMDz6j67d2mOr6xZPwo4RS37PC+j/tXcu9LJ7SuBMEiUMcI0DKaDhUyTsE9nuGb8Qs0qMP4mjYVHerIcHlPRjcewu4m9bmIHhiVw0eWx27zuQYnnm26SaLybF0BDhDt7ZEI4W+7f3qPfH5QIHmI82CJXn4jeWDTZ1nvsOcrEdm7wD+UkF2IHdBbQq1kHprAF2lQoP2N/VvRIfNS8oF2zSmMGoCWR3bkc3us6sWV5onX9y1onFBkEpPlk+3Sb1JMkRp1qjTEAfRqGZtac6UW6GO559cqcSBXhZ7T5ReBULA4+N0C8Fsj57ShxLcwUS/Mbq4FATfEOTdLPKdOeOHwEI0DDUW3E2tAe6wTAwXEi3gjuYpn1giqKjKYLMur2DBBuigwNBodYF8RvCtvCofIY7RqhIKojcdpp2vx9qpT0Zj+s482TeyCsNCij/99viFULUItAnXeF5/hjncIitTubZizrG3SdRbv+8ZPUzQ08CAwEAAaNCMEAwDgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFHm0WeZ7tuXkAXOACIjIGlj26ZtuMA0GCSqGSIb3DQEBCwUAA4ICAQBVH1ipvLKoUNAMsdgaaSAnKQisYXVcim74guVpL9X2Vku5uHMQWdMhl37nTHH7stJgrTmoC+oXIVaF8VAOWevO4FnpuskV74adj4SA9uTpkZDcF5tiG0XwZpXSfG/C6jvvH8/L1q4n8amwyK79fX6a+iIE6//Zf+qRKyKxFw6P8oo0W1jY/AHJVLm4JsyKiDOJTC2EPILf7pZXBbosu/fEt8dOO4K+Mcgic3OS0cKApDk5EDMjgkw8n4ayVZgdvimGjCKbnuJrO1c6gnBN3AnHicsKB01s6F2Oye/Oq8e7tStORdZK0CbM5XLKCGqlleMVofek7cksX6X7/6woAi6+13u743F7kBbTB15GU3w3B0KM08SWnNWZtSrglRqASK5MOQfOzEekUpUrurj7rdIzU33lHU1t1aGxx0Jv5kAnNVyjKLcHjeeNM5DnI5/7UJx5bEbVtBWzlm5+mwyWOrhSLT/WW+H7CMKE/iSoo4narGrhGCqxqENhW9Mf3DuNdvIt6I113xczbD1T+3vLQV//3KLQYTjhlrisXYs313XVM8CZEa6dQcFydYS+AkFCX2ckSJTRmye+Bz+5uE+BdFHherftnSPivuDVKAQTPDEDnt16bI/GBxjGf95Hjj8ongQGz6VUNHe97Imb6RdD31vbX/6OHleizUCdfmIi2t4YJwAAAAEAAAACaDIAAQAAAABgdGxzZmxhZ3MweDAwMDAwMDAwOnBpaG9sZS5hcGV4LW1pZ3JhdGlvbnMubmV0OjQ0M15wYXJ0aXRpb25LZXk9JTI4aHR0cHMlMkNhcGV4LW1pZ3JhdGlvbnMubmV0JTI5AQA= request-method GET response-head HTTP/2 200 
accept-ranges: bytes
alt-svc: h3=":443"; ma=2592000
content-security-policy: default-src 'self' 'unsafe-inline';
content-type: application/javascript
date: Mon, 04 Mar 2024 11:54:51 GMT
etag: "2113692987"
last-modified: Wed, 14 Feb 2024 19:19:00 GMT
referrer-policy: same-origin
server: lighttpd/1.4.59
x-content-type-options: nosniff
x-frame-options: DENY
x-permitted-cross-domain-policies: none
x-pi-hole: The Pi-hole Web interface is working!
x-xss-protection: 0
content-length: 17719
X-Firefox-Spdy: h2
 original-response-headers accept-ranges: bytes
alt-svc: h3=":443"; ma=2592000
content-security-policy: default-src 'self' 'unsafe-inline';
content-type: application/javascript
date: Mon, 04 Mar 2024 11:54:51 GMT
etag: "2113692987"
last-modified: Wed, 14 Feb 2024 19:19:00 GMT
referrer-policy: same-origin
server: lighttpd/1.4.59
x-content-type-options: nosniff
x-frame-options: DENY
x-permitted-cross-domain-policies: none
x-pi-hole: The Pi-hole Web interface is working!
x-xss-protection: 0
content-length: 17719
X-Firefox-Spdy: h2
 ctid 2 uncompressed-len 0 net-response-time-onstart 30 net-response-time-onstop 48   E7